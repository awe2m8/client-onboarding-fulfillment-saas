:root {
  --ui-space-1: 4px;
  --ui-space-2: 8px;
  --ui-space-3: 12px;
  --ui-space-4: 16px;
  --ui-space-5: 20px;
  --ui-space-6: 24px;

  --ui-text-sm: 0.88rem;
  --ui-text-base: 1rem;
  --ui-text-lg: 1.12rem;
  --ui-text-xl: 1.25rem;
}

body {
  line-height: 1.45;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}

html[data-theme="dark"] body {
  background: radial-gradient(circle at 10% 6%, #1a2528 0%, #0f1518 44%),
    radial-gradient(circle at 92% 18%, #12333b 0%, transparent 44%),
    linear-gradient(160deg, #0f1518, #111a1f 48%, #131e23);
  color: var(--ink, var(--pm-ink, var(--rt-ink, var(--ui-color-text))));
}

.app-header h1,
.pm-header h1,
.sp-header h1,
.rt-header h1,
.launcher-head h1 {
  line-height: 1.15;
}

.subtitle,
.pm-header p,
.sp-header p,
.rt-header p,
.launcher-head p {
  max-width: 72ch;
}

.panel,
.pm-panel,
.sp-panel,
.rt-panel {
  border-radius: var(--ui-radius-lg);
  box-shadow: 0 1px 0 rgba(20, 33, 27, 0.04), 0 10px 22px rgba(20, 33, 27, 0.05);
}

html[data-theme="dark"] .panel,
html[data-theme="dark"] .pm-panel,
html[data-theme="dark"] .sp-panel,
html[data-theme="dark"] .rt-panel {
  border-color: var(--line, var(--pm-line, var(--rt-line, var(--ui-color-border))));
  background: linear-gradient(180deg, rgba(21, 33, 38, 0.96), rgba(18, 29, 34, 0.94));
  box-shadow: 0 12px 26px rgba(0, 0, 0, 0.33);
}

html[data-theme="dark"] .app-header,
html[data-theme="dark"] .pm-header,
html[data-theme="dark"] .sp-header,
html[data-theme="dark"] .rt-header,
html[data-theme="dark"] .launcher-section {
  border-color: var(--line, var(--pm-line, var(--rt-line, var(--ui-color-border))));
  background: linear-gradient(120deg, rgba(19, 31, 36, 0.94), rgba(17, 28, 33, 0.92));
}

.panel h2,
.pm-panel h2,
.sp-panel h2,
.rt-panel-head h2 {
  line-height: 1.2;
  letter-spacing: -0.01em;
}

.panel-note,
.pm-panel-note,
.sp-panel-note {
  font-size: var(--ui-text-sm);
}

.panel-head p,
.pm-panel-head p,
.sp-panel-head p,
.rt-panel-head p {
  font-size: var(--ui-text-sm);
  line-height: 1.45;
}

button,
.app-badge,
.pm-card,
.sp-card,
.rt-item {
  transition: transform var(--ui-transition-fast), border-color var(--ui-transition-fast),
    box-shadow var(--ui-transition-fast), background var(--ui-transition-fast), color var(--ui-transition-fast);
}

.app-badge,
.pm-card,
.sp-card,
.rt-item {
  border-radius: var(--ui-radius-lg);
}

html[data-theme="dark"] .app-badge,
html[data-theme="dark"] .pm-card,
html[data-theme="dark"] .sp-card,
html[data-theme="dark"] .rt-item,
html[data-theme="dark"] .list-item,
html[data-theme="dark"] .pm-list-item,
html[data-theme="dark"] .sp-list-item {
  border-color: var(--line, var(--pm-line, var(--rt-line, var(--ui-color-border))));
  background: #152229;
}

html[data-theme="dark"] .column,
html[data-theme="dark"] .pm-column,
html[data-theme="dark"] .sp-column,
html[data-theme="dark"] .sub-panel,
html[data-theme="dark"] .pm-subpanel,
html[data-theme="dark"] .sp-subpanel,
html[data-theme="dark"] .pm-task-column,
html[data-theme="dark"] .sp-goal-column {
  border-color: var(--line, var(--pm-line, var(--rt-line, var(--ui-color-border))));
  background: linear-gradient(180deg, #142128, #111d23);
}

html[data-theme="dark"] .column-head,
html[data-theme="dark"] .pm-column-head,
html[data-theme="dark"] .sp-column-head {
  border-bottom-color: var(--line, var(--pm-line, var(--rt-line, var(--ui-color-border))));
  background: #132026;
}

html[data-theme="dark"] .column-dropzone,
html[data-theme="dark"] .pm-dropzone,
html[data-theme="dark"] .sp-dropzone {
  background: #101b20;
}

html[data-theme="dark"] .card-meta,
html[data-theme="dark"] .card-updated,
html[data-theme="dark"] .empty-col,
html[data-theme="dark"] .pm-card-meta,
html[data-theme="dark"] .pm-card-updated,
html[data-theme="dark"] .pm-empty-col,
html[data-theme="dark"] .sp-card-meta,
html[data-theme="dark"] .sp-card-updated,
html[data-theme="dark"] .sp-empty-col,
html[data-theme="dark"] .detail-empty,
html[data-theme="dark"] .pm-detail-empty,
html[data-theme="dark"] .sp-detail-empty,
html[data-theme="dark"] .empty-state,
html[data-theme="dark"] .pm-empty-state,
html[data-theme="dark"] .sp-empty-state,
html[data-theme="dark"] .subtitle,
html[data-theme="dark"] .launcher-head p,
html[data-theme="dark"] .launcher-section-head p,
html[data-theme="dark"] .panel-note,
html[data-theme="dark"] .pm-panel-note,
html[data-theme="dark"] .sp-panel-note {
  color: var(--muted, var(--pm-muted, var(--rt-muted, var(--ui-color-muted))));
}

.app-badge:focus-visible {
  border-color: var(--brand, var(--ui-color-brand));
}

button.ghost,
button.pm-ghost,
button.sp-ghost,
button.rt-ghost,
.link-button.ghost {
  background: #fff;
  border-color: var(--line, var(--pm-line, var(--rt-line, var(--ui-color-border))));
  color: var(--ink, var(--pm-ink, var(--rt-ink, var(--ui-color-text))));
}

button.ghost:hover,
button.pm-ghost:hover,
button.sp-ghost:hover,
button.rt-ghost:hover,
.link-button.ghost:hover {
  border-color: var(--brand, var(--pm-brand, var(--rt-brand, var(--ui-color-brand))));
  color: var(--brand, var(--pm-brand, var(--rt-brand, var(--ui-color-brand))));
}

.app-kicker,
.pm-badge,
.sp-badge,
.pm-status-chip,
.sp-status-chip,
.pm-task-owner-chip {
  letter-spacing: 0.01em;
}

.eyebrow,
.pm-eyebrow,
.sp-eyebrow,
.rt-eyebrow,
.launcher-eyebrow {
  letter-spacing: 0.09em;
}

/* Better visual grouping in dense detail forms. */
.client-form,
.pm-form,
.sp-form,
.rt-form,
.pm-detail-grid,
.sp-detail-grid {
  row-gap: var(--ui-space-3);
}

.metric-grid article,
.pm-metric-grid article,
.sp-metric-grid article {
  border-radius: var(--ui-radius-md);
}

.board,
.pm-board,
.sp-board {
  gap: var(--ui-space-3);
}

.column,
.pm-column,
.sp-column {
  border-radius: var(--ui-radius-lg);
}

.column-head,
.pm-column-head,
.sp-column-head {
  border-top-left-radius: var(--ui-radius-md);
  border-top-right-radius: var(--ui-radius-md);
}

.column-dropzone,
.pm-dropzone,
.sp-dropzone {
  min-height: 200px;
  padding: 10px;
  border-bottom-left-radius: var(--ui-radius-md);
  border-bottom-right-radius: var(--ui-radius-md);
}

.card,
.pm-card,
.sp-card {
  border-radius: var(--ui-radius-md);
}

.card:hover,
.pm-card:hover,
.sp-card:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 20px rgba(18, 31, 25, 0.12);
}

.card.is-dragging,
.pm-card.is-dragging,
.sp-card.is-dragging {
  transform: none;
}

.detail-wrap,
.pm-detail-wrap,
.sp-detail-wrap {
  gap: 14px;
}

.detail-section,
.pm-detail-section,
.sp-detail-section {
  border-radius: var(--ui-radius-md);
}

.rt-list {
  gap: 12px;
}

.rt-item {
  padding: 12px;
}

/* Dark readability tuning across all app modules. */
html[data-theme="dark"] ::placeholder {
  color: #95a9a2;
  opacity: 1;
}

html[data-theme="dark"] .metric-grid article,
html[data-theme="dark"] .pm-metric-grid article,
html[data-theme="dark"] .sp-metric-grid article {
  border-color: #31454d;
  background: linear-gradient(180deg, #18262d, #142128);
}

html[data-theme="dark"] .metric-grid span,
html[data-theme="dark"] .pm-metric-grid span,
html[data-theme="dark"] .sp-metric-grid span {
  color: #e9f4ef;
}

html[data-theme="dark"] .count-pill,
html[data-theme="dark"] .pm-count-pill,
html[data-theme="dark"] .sp-count-pill,
html[data-theme="dark"] .rt-count-pill {
  border-color: #36525b;
  background: #1a2b31;
  color: #d6e8e1;
}

html[data-theme="dark"] button.ghost,
html[data-theme="dark"] button.pm-ghost,
html[data-theme="dark"] button.sp-ghost,
html[data-theme="dark"] button.rt-ghost,
html[data-theme="dark"] .link-button.ghost,
html[data-theme="dark"] .pm-link,
html[data-theme="dark"] .sp-link,
html[data-theme="dark"] .rt-link,
html[data-theme="dark"] .file-upload {
  border-color: #31454d;
  background: #152229;
  color: var(--ink, var(--pm-ink, var(--rt-ink, var(--ui-color-text))));
}

html[data-theme="dark"] .inline-toggle,
html[data-theme="dark"] .pm-inline-toggle,
html[data-theme="dark"] .sp-inline-toggle {
  border-color: #31454d;
  background: #152229;
  color: var(--ink, var(--pm-ink, var(--rt-ink, var(--ui-color-text))));
}

html[data-theme="dark"] .app-kicker {
  border-color: #346457;
  background: #16312b;
  color: #a6dfce;
}

html[data-theme="dark"] .launcher-grid-external .app-kicker {
  border-color: #5c4f71;
  background: #2b2437;
  color: #d9c8ed;
}

html[data-theme="dark"] .badge.form {
  border-color: #4d6e98;
  background: #21334a;
  color: #c8dcff;
}

html[data-theme="dark"] .badge.payment {
  border-color: #82613e;
  background: #3a2d20;
  color: #ffd8b4;
}

html[data-theme="dark"] .badge.payment.paid {
  border-color: #44745d;
  background: #20352c;
  color: #bbf2d4;
}

html[data-theme="dark"] .badge.payment.issue {
  border-color: #7d4349;
  background: #3a2228;
  color: #ffc2c6;
}

html[data-theme="dark"] .pm-priority-low {
  border-color: #44745d;
  background: #20352c;
  color: #bbf2d4;
}

html[data-theme="dark"] .pm-priority-medium {
  border-color: #4d6e98;
  background: #21334a;
  color: #c8dcff;
}

html[data-theme="dark"] .pm-priority-high {
  border-color: #82613e;
  background: #3a2d20;
  color: #ffd8b4;
}

html[data-theme="dark"] .pm-priority-critical,
html[data-theme="dark"] .pm-blocked {
  border-color: #7d4349;
  background: #3a2228;
  color: #ffc2c6;
}

html[data-theme="dark"] .pm-card-overdue,
html[data-theme="dark"] .sync-status.error,
html[data-theme="dark"] .pm-sync-status.error,
html[data-theme="dark"] .sp-sync-status.error,
html[data-theme="dark"] .rt-status.error {
  color: #f0a8ab;
}

html[data-theme="dark"] .sync-status.ok,
html[data-theme="dark"] .pm-sync-status.ok,
html[data-theme="dark"] .sp-sync-status.ok,
html[data-theme="dark"] .rt-status.ok {
  color: #9de6bf;
}

html[data-theme="dark"] .task-owner-chip {
  border-color: #386556;
  background: #1a322a;
  color: #afe6d0;
}

html[data-theme="dark"] .pm-task-owner-chip.pm-owner-jesse {
  border-color: #537699;
  background: #1d2f43;
  color: #c7ddff;
}

html[data-theme="dark"] .pm-task-owner-chip.pm-owner-giles {
  border-color: #4a7a58;
  background: #1e3326;
  color: #c1efcc;
}

html[data-theme="dark"] .task-status-todo,
html[data-theme="dark"] .pm-status-todo,
html[data-theme="dark"] .sp-status-todo {
  border-color: #7d4349;
  background: #3a2228;
  color: #ffc2c6;
}

html[data-theme="dark"] .task-status-in-progress,
html[data-theme="dark"] .pm-status-in-progress,
html[data-theme="dark"] .sp-status-in-progress {
  border-color: #80633f;
  background: #3b2d20;
  color: #ffddb8;
}

html[data-theme="dark"] .task-status-done,
html[data-theme="dark"] .pm-status-done,
html[data-theme="dark"] .sp-status-done {
  border-color: #44745d;
  background: #20352c;
  color: #bbf2d4;
}

html[data-theme="dark"] .pm-task-column.pm-owner-jesse {
  border-color: #48688a;
  background: linear-gradient(180deg, #172633, #14222e);
}

html[data-theme="dark"] .pm-task-column.pm-owner-giles {
  border-color: #456f52;
  background: linear-gradient(180deg, #182a20, #14231b);
}

html[data-theme="dark"] .pm-task-column.pm-owner-jesse h4 {
  color: #c7ddff;
}

html[data-theme="dark"] .pm-task-column.pm-owner-giles h4 {
  color: #c1efcc;
}

html[data-theme="dark"] .sp-badge {
  border-color: #396656;
  background: #1a322a;
  color: #afe6d0;
}

html[data-theme="dark"] .sp-badge.warn {
  border-color: #80633f;
  background: #3b2d20;
  color: #ffddb8;
}

html[data-theme="dark"] .sp-goal-column.sp-owner-jesse {
  border-color: #48688a;
  background: linear-gradient(180deg, #172633, #14222e);
}

html[data-theme="dark"] .sp-goal-column.sp-owner-giles {
  border-color: #456f52;
  background: linear-gradient(180deg, #182a20, #14231b);
}

html[data-theme="dark"] .sp-goal-column.sp-owner-jesse h4 {
  color: #c7ddff;
}

html[data-theme="dark"] .sp-goal-column.sp-owner-giles h4 {
  color: #c1efcc;
}

html[data-theme="dark"] .sp-goal-column.sp-owner-jesse .sp-list-item {
  border-color: #3f6080;
  background: #172835;
}

html[data-theme="dark"] .sp-goal-column.sp-owner-giles .sp-list-item {
  border-color: #3f664b;
  background: #17271d;
}

html[data-theme="dark"] .sp-subtask-details,
html[data-theme="dark"] .sp-subtask-item,
html[data-theme="dark"] .sp-collapsible,
html[data-theme="dark"] .sp-activity-details {
  border-color: #31454d;
  background: #152229;
}

html[data-theme="dark"] .sp-subtask-details summary,
html[data-theme="dark"] .sp-collapsible summary,
html[data-theme="dark"] .sp-activity-details summary {
  color: #d6e8e1;
}

html[data-theme="dark"] .sp-subtask-details[open] summary,
html[data-theme="dark"] .sp-collapsible[open] summary,
html[data-theme="dark"] .sp-activity-details[open] summary {
  border-bottom-color: #31454d;
}

html[data-theme="dark"] .rt-chip {
  border-color: #3f6f60;
  background: #1b352d;
  color: #bbeed8;
}

html[data-theme="dark"] .rt-chip.loom {
  border-color: #4f7398;
  background: #21344b;
  color: #c8dcff;
}

html[data-theme="dark"] .rt-chip.summary {
  border-color: #3f6f60;
  background: #1b352d;
  color: #bbeed8;
}

html[data-theme="dark"] .rt-chip.decision {
  border-color: #7d4349;
  background: #3a2228;
  color: #ffc2c6;
}

html[data-theme="dark"] .rt-item.rt-overdue {
  border-color: #7d4349;
  background: #332126;
}

html[data-theme="dark"] .rt-loom-link {
  color: #b8d7ff;
}

html[data-theme="dark"] .rt-ack-block {
  border-color: #31454d;
  background: #152229;
}

.theme-dock {
  position: fixed;
  right: 14px;
  bottom: 14px;
  z-index: 2200;
}

.theme-dock-panel {
  border: 1px solid var(--line, var(--pm-line, var(--rt-line, var(--ui-color-border))));
  border-radius: 12px;
  background: rgba(255, 255, 255, 0.92);
  box-shadow: 0 8px 22px rgba(21, 30, 25, 0.16);
  backdrop-filter: blur(6px);
}

html[data-theme="dark"] .theme-dock-panel {
  background: rgba(18, 29, 34, 0.92);
  box-shadow: 0 10px 24px rgba(0, 0, 0, 0.45);
}

.theme-dock-panel > summary {
  list-style: none;
  cursor: pointer;
  padding: 8px 10px;
  font-size: 0.82rem;
  font-weight: 700;
  color: var(--ink, var(--pm-ink, var(--rt-ink, var(--ui-color-text))));
  user-select: none;
}

.theme-dock-panel > summary::-webkit-details-marker {
  display: none;
}

.theme-dock-panel[open] > summary {
  border-bottom: 1px solid var(--line, var(--pm-line, var(--rt-line, var(--ui-color-border))));
}

.theme-dock-content {
  display: grid;
  gap: 8px;
  padding: 10px;
  min-width: 190px;
}

.theme-dock-content label {
  display: grid;
  gap: 4px;
  color: var(--muted, var(--pm-muted, var(--rt-muted, var(--ui-color-muted))));
  font-size: 0.78rem;
}

/* Improve keyboard discoverability on control clusters. */
.form-actions button:focus-visible,
.pm-form-actions button:focus-visible,
.sp-form-actions button:focus-visible,
.rt-form-actions button:focus-visible {
  box-shadow: var(--ui-focus-ring);
}

@media (max-width: 780px) {
  .app-header,
  .pm-header,
  .sp-header,
  .rt-header {
    gap: var(--ui-space-3);
  }

  .panel,
  .pm-panel,
  .sp-panel,
  .rt-panel {
    padding: var(--ui-space-3);
  }

  .theme-dock {
    right: 10px;
    bottom: 10px;
  }
}
